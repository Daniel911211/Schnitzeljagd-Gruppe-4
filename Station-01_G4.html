<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Schnitzeljagd ‚Äì Station 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#020617;
  color:#e5e7eb;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

/* CARD */
.card{
  background:#0f172a;
  padding:24px;
  border-radius:16px;
  width:360px;
  box-shadow:0 20px 40px rgba(0,0,0,.6);
}

h1{
  text-align:center;
  color:#60a5fa;
  margin-top:0;
}

/* TIMER */
#timer{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:6px;
  margin-bottom:16px;
  color:#a5f3fc;
  font-weight:bold;
}

/* SECTION */
.section{
  margin-bottom:18px;
}

/* INPUT */
.section input{
  width:100%;
  box-sizing:border-box;
  padding:12px;
  border-radius:10px;
  border:1px solid #334155;
  background:#020617;
  color:#e5e7eb;
  font-size:1rem;
}

/* BUTTON */
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  background:#2563eb;
  color:white;
  font-weight:bold;
  cursor:pointer;
}

.hidden{display:none;}

/* ERFOLG */
.erfolgBox{
  text-align:center;
}
.checkIcon{
  width:48px;
  height:48px;
  margin:0 auto 12px;
  border-radius:10px;
  background:#22c55e;
  color:#fff;
  font-size:28px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.erfolgText{
  font-size:1.4rem;
  font-weight:bold;
  margin-bottom:16px;
}
.raetselBox{
  padding:16px;
  border-radius:14px;
  background:rgba(34,197,94,0.12);
  border:1px solid rgba(34,197,94,0.45);
  color:#bbf7d0;
  line-height:1.6;
}

  .buchstabenBox.feuer{
  background:rgba(239,68,68,0.12);
  border:2px solid rgba(239,68,68,0.6);
}

.buchstabenBox.feuer .buchstabe{
  color:#fecaca;
}
  .buchstabenBox{
  margin-top:20px;
  padding:16px;
  border-radius:14px;
  text-align:center;
}

.buchstabenTitel{
  font-size:1.1rem;
  font-weight:bold;
  margin-bottom:8px;
}

.buchstabe{
  font-size:3.5rem;
  font-weight:bold;
  letter-spacing:4px;
}

</style>
</head>

<body>

<div class="card">

<!-- HEADER -->
<div id="header">
  <h1>üìç Station 1</h1>
  <div id="timer">‚è±Ô∏è Zeit: 0 s</div>
</div>

<!-- FORMULAR -->
<form
  id="formular"
  action="https://docs.google.com/forms/d/e/1FAIpQLSf2c7-3JTvk9BarK9MBxpo73ykdESEy84IV-Yo7OxPOvg6zOw/formResponse"
  method="POST"
  target="hidden_iframe"
  onsubmit="return auswerten();">

  <!-- feste Werte -->
  <input type="hidden" name="entry.1841279378" value="1"> <!--Gruppe-->
  <input type="hidden" name="entry.1611288883" value="1"> <!--Station-->
  <input type="hidden" name="entry.476999913" id="punkte" value="0">
  <input type="hidden" name="entry.1051828811" id="zeit">

  <div class="section">
    <strong>üß© Hauptfrage</strong><br><br>
    Wie lautet die europ√§ische Notrufnummer?<br><br>
    <input
      type="text"
      id="antwort"
      name="entry.1865983702"
      placeholder="Antwort eingeben"
      required>
  </div>

  <div id="gpsStatus" style="margin:10px 0; font-size:0.9rem; color:#fde68a;">
üì° Standort wird gepr√ºft ‚Ä¶
</div>


  <button type="submit">Antworten absenden</button>
</form>

<!-- ERFOLG -->
<div id="erfolg" class="hidden erfolgBox">
  <div class="checkIcon">‚úî</div>
  <div class="erfolgText">Antwort gesendet!</div>

  <div class="raetselBox">
    üß© <strong>R√§tsel zur n√§chsten Station</strong><br><br>

    Kein Wohnort,<br>
    kein Ziel zum Bleiben.<br><br>

    Unter einem gro√üen Dach<br>
    wird Energie weitergegeben.<br><br>

    Findet den Ort,<br>
    an dem Fahrzeuge pausieren.
  </div>

<div class="buchstabenBox feuer">
  <div class="buchstabenTitel">üîê Euer L√∂sungsbuchstabe</div>
  <div class="buchstabe">I</div>
  </div>
 
</div>

<iframe name="hidden_iframe" style="display:none;"></iframe>

</div>

<script>
const start = Date.now();

  // ZIEL-KOORDINATEN (HIER ANPASSEN!)
const ZIEL_LAT = 50.450514;  
const ZIEL_LON = 9.614289;
const TOLERANZ_METER = 30;

let gpsOK = false;


setInterval(()=>{
  document.getElementById("timer").innerText =
    "‚è±Ô∏è Zeit: " + Math.floor((Date.now()-start)/1000) + " s";
},1000);


  
navigator.geolocation.getCurrentPosition(
  pos => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;

    const dist = berechneDistanz(lat, lon, ZIEL_LAT, ZIEL_LON);

    if (dist <= TOLERANZ_METER) {
      gpsOK = true;
      document.getElementById("gpsStatus").innerText =
        "‚úÖ Du bist am richtigen Standort";
    } else {
      gpsOK = false;
      document.getElementById("gpsStatus").innerText =
        "üìç Du bist noch nicht am richtigen Standort";
    }
  },
  err => {
    document.getElementById("gpsStatus").innerText =
      "üì° Bitte Standortfreigabe erlauben";
  }
);


  function berechneDistanz(lat1, lon1, lat2, lon2){
  const R = 6371000;
  const dLat = (lat2-lat1) * Math.PI/180;
  const dLon = (lon2-lon1) * Math.PI/180;
  const a =
    Math.sin(dLat/2)**2 +
    Math.cos(lat1*Math.PI/180) *
    Math.cos(lat2*Math.PI/180) *
    Math.sin(dLon/2)**2;
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
}


function auswerten(){

  if (!gpsOK) {
  alert("üìç Du bist noch nicht am richtigen Standort.");
  return false;
}


 // Zeit setzen
  document.getElementById("zeit").value =
    Math.floor((Date.now()-start)/1000);

  // Punkte
  const antwort = document.getElementById("antwort").value.trim();
  document.getElementById("punkte").value =
    (antwort === "112") ? 10 : 0;

  // UI umschalten
  document.getElementById("formular").classList.add("hidden");
  document.getElementById("header").classList.add("hidden");
  document.getElementById("erfolg").classList.remove("hidden");

  return true; // Google Form absenden
}
</script>

</body>
</html>
